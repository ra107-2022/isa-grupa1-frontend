<div class="comment-section">
  <!-- Dodavanje komentara -->
  <div *ngIf="isAuthenticated" class="add-comment">
    <textarea [(ngModel)]="newCommentText" placeholder="Add comment..."></textarea>
    <button (click)="onAddComment()">Add Comment</button>
  </div>

  <!-- Napomena za login -->
  <div *ngIf="!isAuthenticated" class="login-note">
    You must be logged in to add comments.
  </div>

  <!-- Lista komentara -->
  <div *ngFor="let comment of comments" class="comment">
    <div class="comment-header">
        <a class="username" 
        [routerLink]="currentUserId === comment.authorId ? '/users/me' : ['/users', comment.authorId]">
        {{ comment.authorUsername }}
        </a>

      <span class="date">{{ comment.createdAt | date:'short' }}</span>

      <!-- Dugmad za edit/delete ako je autor -->
      <div class="actions" *ngIf="isAuthenticated">
        <button (click)="editTextMap[comment.commentId] = comment.content">Edit</button>
        <button (click)="onDeleteComment(comment.commentId)">Delete</button>
      </div>
    </div>

    <!-- Edit polje -->
    <div *ngIf="editTextMap[comment.commentId] !== undefined" class="edit-comment">
      <textarea [(ngModel)]="editTextMap[comment.commentId]"></textarea>
      <button (click)="onEditComment(comment.commentId)">Save</button>
      <button (click)="cancelEdit(comment.commentId)">Cancel</button>
    </div>

    <!-- Prikaz komentara -->
    <p *ngIf="editTextMap[comment.commentId] === undefined">{{ comment.content }}</p>
  </div>

  <!-- Paginacija -->
  <div class="pagination">
    <button (click)="prevPage()" [disabled]="currentPage === 0">Previous</button>
    <span>Page {{ currentPage + 1 }} of {{ totalPages }}</span>
    <button (click)="nextPage()" [disabled]="currentPage + 1 >= totalPages">Next</button>
  </div>
</div>