<div class="upload-container">
  <h2>Upload Video</h2>

  <div class="alert alert-success" *ngIf="uploadSuccess">
    Video uploaded successfully!
  </div>

  <div class="alert alert-error" *ngIf="uploadError">
    {{ uploadError }}
  </div>

  <form (ngSubmit)="uploadVideo()">
    <div class="form-group">
      <label for="title">Title *</label>
      <input
        type="text"
        id="title"
        [(ngModel)]="uploadForm.title"
        name="title"
        placeholder="Enter video title"
        required
        [disabled]="uploading"
      >
    </div>

    <div class="form-group">
      <label for="description">Description *</label>
      <textarea
        id="description"
        [(ngModel)]="uploadForm.description"
        name="description"
        rows="4"
        placeholder="Describe your video"
        required
        [disabled]="uploading"
      ></textarea>
    </div>

    <div class="form-group">
      <label for="video">Video File *</label>
      <input
        type="file"
        id="video"
        (change)="onVideoSelect($event)"
        accept="video/*"
        required
        class="darker-font"
        [disabled]="uploading"
      >
      <div class="file-info" *ngIf="videoFile">
        <span class="darker-font">{{ videoFile.name }}</span>
        <span class="file-size">({{ (videoFile.size / 1024 / 1024).toFixed(2) }} MB)</span>
      </div>
    </div>

    <div class="form-group">
      <label for="thumbnail">Thumbnail *</label>
      <input
        type="file"
        id="thumbnail"
        (change)="onThumbnailSelect($event)"
        accept="image/*"
        required
        class="darker-font"
        [disabled]="uploading"
      >
      <div class="thumbnail-preview" *ngIf="thumbnailPreview">
        <img [src]="thumbnailPreview" alt="Thumbnail preview" id="thumbnailImg">
      </div>
    </div>

    <div class="form-group">
      <label for="tags">Tags * (comma-separated)</label>
      <input
        type="text"
        id="tags"
        [(ngModel)]="uploadForm.tags"
        name="tags"
        placeholder="travel, vlog, adventure"
        required
        [disabled]="uploading"
      >
      <small>Separate tags with commas</small>
    </div>

    <div *ngIf="automaticGeoloc">
      <button
        type="button"
        (click)="getLocation()"
        [disabled]="gettingLocation"
      >
        {{ gettingLocation ? 'Getting location...' : 'Use My Location' }}
      </button>

      <div *ngIf="uploadForm.latitude && uploadForm.longitude">
        <p class="darker-font">Latitude: {{ uploadForm.latitude }}</p>
        <p class="darker-font">Longitude: {{ uploadForm.longitude }}</p>
      </div>
    </div>

    <div class="form-row" *ngIf="!automaticGeoloc">
      <div class="form-group">
        <label for="latitude">Latitude (optional)</label>
        <input
          type="number"
          id="latitude"
          [(ngModel)]="uploadForm.latitude"
          name="latitude"
          step="any"
          class="darker-font"
          placeholder="e.g., 40.7128"
          [disabled]="uploading"
        >
      </div>

      <div class="form-group">
        <label for="longitude">Longitude (optional)</label>
        <input
          type="number"
          id="longitude"
          [(ngModel)]="uploadForm.longitude"
          name="longitude"
          step="any"
          placeholder="e.g., -74.0060"
          class="darker-font"
          [disabled]="uploading"
        >
      </div>
    </div>

    <div class="progress-container" *ngIf="uploading">
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="uploadProgress">
          {{ uploadProgress }}%
        </div>
      </div>
      <p class="progress-text">Uploading... Please don't close this page</p>
    </div>

    <div class="button-group">
      <button
        type="button"
        class="btn btn-secondary"
        (click)="cancelUpload()"
        [disabled]="uploading"
      >
        Clear
      </button>
      <button
        type="submit"
        class="btn btn-primary"
        [disabled]="uploading || !videoFile || !thumbnailFile"
      >
        {{ uploading ? 'Uploading...' : 'Upload Video' }}
      </button>
    </div>
  </form>
</div>
